#include <WiFi.h>
#include <HTTPClient.h>

// WiFi credentials
const char* ssid = "Your_WiFi_SSID";
const char* password = "Your_WiFi_Password";

// Server API endpoint
const char* serverUrl = "http://your-server-ip/update_queue"; // Replace with backend URL

void setup() {
    Serial.begin(115200);

    // Connect to WiFi
    WiFi.begin(ssid, password);
    Serial.print("Connecting to WiFi");
    while (WiFi.status() != WL_CONNECTED) {
        delay(1000);
        Serial.print(".");
    }
    Serial.println("\nConnected to WiFi!");
}

void loop() {
    int queueCount = random(1, 10);  // Simulated queue count (Replace with real sensor data)

    if (WiFi.status() == WL_CONNECTED) {
        HTTPClient http;
        http.begin(serverUrl);
        http.addHeader("Content-Type", "application/json");

        // JSON payload
        String payload = "{\"queue_count\": " + String(queueCount) + "}";
        int httpResponseCode = http.POST(payload);

        if (httpResponseCode > 0) {
            Serial.println("Data sent: " + payload);
        } else {
            Serial.println("Error sending data.");
        }
        http.end();
    }

    delay(5000);  // Send data every 5 seconds
}
